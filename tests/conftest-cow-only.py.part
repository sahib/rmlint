# This file is meant to be appended to conftest.py to the the test suite

def pytest_collection_modifyitems(items, config):
    selected_items = []
    deselected_items = []

    for item in items:
        if "needs_reflink_fs" in getattr(item, "fixturenames", ()):
            selected_items.append(item)
        else:
            deselected_items.append(item)
    config.hook.pytest_deselected(items=deselected_items)
    items[:] = selected_items
